{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ChatCard from \"../../componnetns/ChatCard\";\nimport Gap from \"../../componnetns/Gap\";\nimport { styles } from \"../../style/style\";\nimport { FAB, Modal, Portal, Text, Button, Card, TouchableRipple, TextInput, IconButton } from \"react-native-paper\";\nimport { PSUT_ChatroomApi } from \"../../api/routeApi\";\nimport { Cache } from \"../../helpers/cache\";\nimport LoadingScreen from \"../../componnetns/LoadingScreen\";\nimport { heightPercentageToDP as hp } from \"react-native-responsive-screen\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar groupSettingState = {\n  Hidden: 1,\n  Options: 2,\n  ChangeName: 3,\n  DeleteGroup: 4,\n  AddMember: 5,\n  RemoveMember: 6,\n  GroupMembers: 7,\n  SelectMemberToAdd: 8\n};\n\nvar Chat = function Chat() {\n  var _groupSetting$memberT, _groupSetting$memberT2;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      refreshing = _useState2[0],\n      setRefreshing = _useState2[1];\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      showFab = _useState4[0],\n      setShowFab = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      groupsList = _useState6[0],\n      setGroupsList = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      admins = _useState8[0],\n      setAdmins = _useState8[1];\n\n  var _useState9 = useState({}),\n      _useState10 = _slicedToArray(_useState9, 2),\n      groupsMembers = _useState10[0],\n      setGroupsMembers = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      pingModalVisible = _useState12[0],\n      setPingModalVisible = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      createGroupModalVisible = _useState14[0],\n      setCreateGroupModalVisible = _useState14[1];\n\n  var _useState15 = useState(\"\"),\n      _useState16 = _slicedToArray(_useState15, 2),\n      newGroupName = _useState16[0],\n      setNewGroupName = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      loading = _useState18[0],\n      setLoading = _useState18[1];\n\n  var _useState19 = useState({\n    currentState: groupSettingState.Hidden\n  }),\n      _useState20 = _slicedToArray(_useState19, 2),\n      groupSetting = _useState20[0],\n      setGroupSetting = _useState20[1];\n\n  var _useState21 = useState(null),\n      _useState22 = _slicedToArray(_useState21, 2),\n      newMembers = _useState22[0],\n      setNewMembers = _useState22[1];\n\n  var nav = useNavigation();\n\n  var _useState23 = useState({\n    open: false\n  }),\n      _useState24 = _slicedToArray(_useState23, 2),\n      state = _useState24[0],\n      setState = _useState24[1];\n\n  var onStateChange = function onStateChange(_ref) {\n    var open = _ref.open;\n    return setState({\n      open: open\n    });\n  };\n\n  var open = state.open;\n  var fabActions = Cache.userData.role === \"Student\" ? [{\n    icon: \"bell\",\n    label: \"Ping Instructor\",\n    onPress: function onPress() {\n      return togglePingModal(true);\n    },\n    small: false\n  }] : Cache.userData.role === \"Instructor\" ? [{\n    icon: \"message-plus-outline\",\n    label: \"Create new group\",\n    onPress: function onPress() {\n      return setCreateGroupModalVisible(true);\n    },\n    small: false\n  }] : [];\n\n  var onCreateGroup = function onCreateGroup() {\n    var _await$PSUT_ChatroomApi$cre, data;\n\n    return _regeneratorRuntime.async(function onCreateGroup$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (newGroupName) {\n              _context.next = 2;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 2:\n            setCreateGroupModalVisible(false);\n            setLoading(true);\n            _context.prev = 4;\n            _context.next = 7;\n            return _regeneratorRuntime.awrap(PSUT_ChatroomApi.createGroup(newGroupName));\n\n          case 7:\n            _await$PSUT_ChatroomApi$cre = _context.sent;\n            data = _await$PSUT_ChatroomApi$cre.data;\n            _context.next = 11;\n            return _regeneratorRuntime.awrap(getGroupsList());\n\n          case 11:\n            setLoading(false);\n            setNewGroupName(\"\");\n            alert(\"Created Successfully, with ID: \" + data.id);\n            _context.next = 20;\n            break;\n\n          case 16:\n            _context.prev = 16;\n            _context.t0 = _context[\"catch\"](4);\n            setLoading(false);\n            alert(\"Failed to create\");\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[4, 16]], Promise);\n  };\n\n  var onUpdateGroup = function onUpdateGroup() {\n    return _regeneratorRuntime.async(function onUpdateGroup$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (newGroupName) {\n              _context2.next = 2;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 2:\n            setGroupSetting(_objectSpread(_objectSpread({}, groupSetting), {}, {\n              currentState: groupSettingState.Hidden\n            }));\n            setLoading(true);\n            _context2.prev = 4;\n            _context2.next = 7;\n            return _regeneratorRuntime.awrap(PSUT_ChatroomApi.updateGroup(groupSetting.id, newGroupName));\n\n          case 7:\n            _context2.next = 9;\n            return _regeneratorRuntime.awrap(getGroupsList());\n\n          case 9:\n            setLoading(false);\n            setNewGroupName(\"\");\n            alert(\"Updated Successfully\");\n            _context2.next = 18;\n            break;\n\n          case 14:\n            _context2.prev = 14;\n            _context2.t0 = _context2[\"catch\"](4);\n            setLoading(false);\n            alert(\"Failed to update\");\n\n          case 18:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[4, 14]], Promise);\n  };\n\n  var onDeleteGroup = function onDeleteGroup() {\n    var groupId;\n    return _regeneratorRuntime.async(function onDeleteGroup$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            groupId = groupSetting.id;\n            setGroupSetting({\n              currentState: groupSettingState.Hidden\n            });\n            setLoading(true);\n            _context3.prev = 3;\n            _context3.next = 6;\n            return _regeneratorRuntime.awrap(PSUT_ChatroomApi.deleteGroup([groupId]));\n\n          case 6:\n            _context3.next = 8;\n            return _regeneratorRuntime.awrap(getGroupsList());\n\n          case 8:\n            setLoading(false);\n            alert(\"Deleted Successfully\");\n            _context3.next = 16;\n            break;\n\n          case 12:\n            _context3.prev = 12;\n            _context3.t0 = _context3[\"catch\"](3);\n            setLoading(false);\n            alert(\"Failed to delete\");\n\n          case 16:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[3, 12]], Promise);\n  };\n\n  var onMemberRemove = function onMemberRemove() {\n    var groupId, userId;\n    return _regeneratorRuntime.async(function onMemberRemove$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            groupId = groupSetting.id;\n            userId = groupSetting.memberToRemove.id;\n            setGroupSetting({\n              currentState: groupSettingState.Hidden\n            });\n            setLoading(true);\n            _context4.prev = 4;\n            _context4.next = 7;\n            return _regeneratorRuntime.awrap(PSUT_ChatroomApi.removeMember({\n              groupId: groupId,\n              userId: userId\n            }));\n\n          case 7:\n            _context4.next = 9;\n            return _regeneratorRuntime.awrap(getGroupsList());\n\n          case 9:\n            setLoading(false);\n            alert(\"Removed Successfully\");\n            _context4.next = 17;\n            break;\n\n          case 13:\n            _context4.prev = 13;\n            _context4.t0 = _context4[\"catch\"](4);\n            setLoading(false);\n            alert(\"Failed to remove\");\n\n          case 17:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[4, 13]], Promise);\n  };\n\n  var onMemberAdd = function onMemberAdd() {\n    var groupId, userId;\n    return _regeneratorRuntime.async(function onMemberAdd$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            groupId = groupSetting.id;\n            userId = groupSetting.memberToAdd.id;\n            setGroupSetting({\n              currentState: groupSettingState.Hidden\n            });\n            setLoading(true);\n            _context5.prev = 4;\n            _context5.next = 7;\n            return _regeneratorRuntime.awrap(PSUT_ChatroomApi.addMember({\n              groupId: groupId,\n              userId: userId,\n              isAdmin: false\n            }));\n\n          case 7:\n            _context5.next = 9;\n            return _regeneratorRuntime.awrap(getGroupsList());\n\n          case 9:\n            setLoading(false);\n            alert(\"Added Successfully\");\n            _context5.next = 17;\n            break;\n\n          case 13:\n            _context5.prev = 13;\n            _context5.t0 = _context5[\"catch\"](4);\n            setLoading(false);\n            alert(\"Failed to add\");\n\n          case 17:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, [[4, 13]], Promise);\n  };\n\n  var fetchNewMembers = function fetchNewMembers() {\n    var _await$PSUT_ChatroomApi$get, data;\n\n    return _regeneratorRuntime.async(function fetchNewMembers$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            _context6.prev = 0;\n            _context6.next = 3;\n            return _regeneratorRuntime.awrap(PSUT_ChatroomApi.getNonExistingMembers(groupSetting.id));\n\n          case 3:\n            _await$PSUT_ChatroomApi$get = _context6.sent;\n            data = _await$PSUT_ChatroomApi$get.data;\n            setNewMembers(data);\n            _context6.next = 11;\n            break;\n\n          case 8:\n            _context6.prev = 8;\n            _context6.t0 = _context6[\"catch\"](0);\n            setNewMembers([]);\n\n          case 11:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, [[0, 8]], Promise);\n  };\n\n  var filterDataDto = function filterDataDto() {\n    var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var mGroups = [];\n    var mAdmins = [];\n    var mGroupsMembers = {};\n\n    for (var _iterator = _createForOfIteratorHelperLoose(array), _step; !(_step = _iterator()).done;) {\n      var group = _step.value;\n      mGroups.push({\n        id: group.id,\n        name: group.name,\n        conversationId: group.conversationId,\n        avatar_url: \"https://source.unsplash.com/random?sig=\" + group.id,\n        adminName: group.members.find(function (m) {\n          return m.isAdmin;\n        }).user.name,\n        adminId: group.members.find(function (m) {\n          return m.isAdmin;\n        }).user.id\n      });\n      mGroupsMembers[group.id] = _toConsumableArray(group.members.filter(function (m) {\n        return !m.isAdmin;\n      }).map(function (u) {\n        return u.user;\n      }));\n      mAdmins.push.apply(mAdmins, _toConsumableArray(group.members.filter(function (m) {\n        return m.isAdmin && !mAdmins.find(function (a) {\n          return a.id === m.user.id;\n        });\n      }).map(function (u) {\n        return u.user;\n      })));\n    }\n\n    setGroupsList(mGroups);\n    setAdmins(mAdmins);\n    setGroupsMembers(mGroupsMembers);\n  };\n\n  useEffect(function () {\n    nav.addListener(\"blur\", function () {\n      return setShowFab(false);\n    });\n    var cleanUp = nav.addListener(\"focus\", function () {\n      setShowFab(true);\n      getGroupsList();\n    });\n    return function () {\n      return cleanUp();\n    };\n  }, [nav]);\n\n  var getGroupsList = function getGroupsList() {\n    var res;\n    return _regeneratorRuntime.async(function getGroupsList$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            _context7.prev = 0;\n            _context7.next = 3;\n            return _regeneratorRuntime.awrap(PSUT_ChatroomApi.getGroups());\n\n          case 3:\n            res = _context7.sent;\n            filterDataDto(res.data);\n            _context7.next = 10;\n            break;\n\n          case 7:\n            _context7.prev = 7;\n            _context7.t0 = _context7[\"catch\"](0);\n            console.log(_context7.t0);\n\n          case 10:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, null, null, [[0, 7]], Promise);\n  };\n\n  var onRefresh = useCallback(function () {\n    setRefreshing(true);\n    getGroupsList().then(function (response) {\n      setRefreshing(false);\n    }, function (error) {\n      setRefreshing(false);\n    });\n  }, []);\n\n  var _onCardPress = function onCardPress(groupData) {\n    return _regeneratorRuntime.async(function onCardPress$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            nav.navigate(\"Meassge\", groupData);\n\n          case 1:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var _onCardLongPress = function onCardLongPress(groupData) {\n    return _regeneratorRuntime.async(function onCardLongPress$(_context9) {\n      while (1) {\n        switch (_context9.prev = _context9.next) {\n          case 0:\n            if (Cache.userData.id === groupData.adminId) {\n              setGroupSetting(_objectSpread(_objectSpread({}, groupData), {}, {\n                currentState: groupSettingState.Options\n              }));\n            } else {\n              alert(\"Only group admin can access it's settings\");\n            }\n\n          case 1:\n          case \"end\":\n            return _context9.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  function pingInstructor(instructorId) {\n    var dto, _e$response;\n\n    return _regeneratorRuntime.async(function pingInstructor$(_context10) {\n      while (1) {\n        switch (_context10.prev = _context10.next) {\n          case 0:\n            togglePingModal();\n            dto = {\n              content: \"PING\",\n              recipientId: instructorId\n            };\n            console.log(dto);\n            _context10.prev = 3;\n            _context10.next = 6;\n            return _regeneratorRuntime.awrap(PSUT_ChatroomApi.sendPing(dto));\n\n          case 6:\n            alert(\"Ping sent successfully\");\n            _context10.next = 13;\n            break;\n\n          case 9:\n            _context10.prev = 9;\n            _context10.t0 = _context10[\"catch\"](3);\n\n            if ((_context10.t0 == null ? void 0 : (_e$response = _context10.t0.response) == null ? void 0 : _e$response.status) === 422) {\n              alert(\"Selected instructor has already been pinged before\");\n            }\n\n            console.log(JSON.stringify(_context10.t0));\n\n          case 13:\n          case \"end\":\n            return _context10.stop();\n        }\n      }\n    }, null, null, [[3, 9]], Promise);\n  }\n\n  var togglePingModal = function togglePingModal() {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n    return setPingModalVisible(function (pre) {\n      return state !== undefined ? state : !pre;\n    });\n  };\n\n  return _jsxs(View, {\n    style: [styles.container, {\n      backgroundColor: \"#F8F8F8\"\n    }],\n    children: [_jsx(LoadingScreen, {\n      visible: loading\n    }), _jsx(Portal, {\n      children: _jsxs(Modal, {\n        visible: groupSetting.currentState === groupSettingState.DeleteGroup,\n        contentContainerStyle: screenStyles.pingModalContainerStyle,\n        children: [_jsx(View, {\n          style: screenStyles.pingModalContent,\n          children: _jsx(Text, {\n            style: {\n              fontSize: 18,\n              marginBottom: 20\n            },\n            children: \"Are you sure you want to delete the group?\"\n          })\n        }), _jsxs(View, {\n          style: {\n            flexDirection: \"row\",\n            justifyContent: \"space-between\"\n          },\n          children: [_jsx(Button, {\n            style: {\n              padding: 8\n            },\n            onPress: function onPress() {\n              return setGroupSetting({\n                currentState: groupSettingState.Hidden\n              });\n            },\n            children: \"Cancel\"\n          }), _jsx(Button, {\n            color: \"crimson\",\n            style: {\n              padding: 8\n            },\n            onPress: function onPress() {\n              return onDeleteGroup();\n            },\n            children: \"Yes, Delete it!\"\n          })]\n        })]\n      })\n    }), _jsx(Portal, {\n      children: _jsxs(Modal, {\n        visible: groupSetting.currentState === groupSettingState.RemoveMember,\n        contentContainerStyle: screenStyles.pingModalContainerStyle,\n        children: [_jsx(View, {\n          style: screenStyles.pingModalContent,\n          children: _jsxs(Text, {\n            style: {\n              fontSize: 18,\n              marginBottom: 20\n            },\n            children: [\"Are you sure you want to remove\", \" \", groupSetting == null ? void 0 : (_groupSetting$memberT = groupSetting.memberToRemove) == null ? void 0 : _groupSetting$memberT.name, \" from the group?\"]\n          })\n        }), _jsxs(View, {\n          style: {\n            flexDirection: \"row\",\n            justifyContent: \"space-between\"\n          },\n          children: [_jsx(Button, {\n            style: {\n              padding: 8\n            },\n            onPress: function onPress() {\n              return setGroupSetting({\n                currentState: groupSettingState.Hidden\n              });\n            },\n            children: \"Cancel\"\n          }), _jsx(Button, {\n            color: \"crimson\",\n            style: {\n              padding: 8\n            },\n            onPress: function onPress() {\n              return onMemberRemove();\n            },\n            children: \"Yes, Remove!\"\n          })]\n        })]\n      })\n    }), _jsx(Portal, {\n      children: _jsxs(Modal, {\n        visible: groupSetting.currentState === groupSettingState.AddMember,\n        contentContainerStyle: screenStyles.pingModalContainerStyle,\n        children: [_jsx(View, {\n          style: screenStyles.pingModalContent,\n          children: _jsxs(Text, {\n            style: {\n              fontSize: 18,\n              marginBottom: 20\n            },\n            children: [\"Are you sure you want to add \", groupSetting == null ? void 0 : (_groupSetting$memberT2 = groupSetting.memberToAdd) == null ? void 0 : _groupSetting$memberT2.name, \" to the group?\"]\n          })\n        }), _jsxs(View, {\n          style: {\n            flexDirection: \"row\",\n            justifyContent: \"space-between\"\n          },\n          children: [_jsx(Button, {\n            style: {\n              padding: 8\n            },\n            onPress: function onPress() {\n              return setGroupSetting({\n                currentState: groupSettingState.Hidden\n              });\n            },\n            children: \"Cancel\"\n          }), _jsx(Button, {\n            color: \"green\",\n            style: {\n              padding: 8\n            },\n            onPress: function onPress() {\n              return onMemberAdd();\n            },\n            children: \"Yes, Add\"\n          })]\n        })]\n      })\n    }), _jsx(Portal, {\n      children: _jsxs(Modal, {\n        visible: groupSetting.currentState === groupSettingState.ChangeName,\n        contentContainerStyle: screenStyles.pingModalContainerStyle,\n        children: [_jsxs(View, {\n          style: screenStyles.pingModalContent,\n          children: [_jsx(Text, {\n            style: {\n              fontSize: 18\n            },\n            children: \"Change Group Name\"\n          }), _jsx(TextInput, {\n            placeholder: \"New Group Name\",\n            multiline: false,\n            mode: \"outlined\",\n            style: {\n              height: 48,\n              marginVertical: 12\n            },\n            value: newGroupName,\n            onChangeText: function onChangeText(text) {\n              return setNewGroupName(text);\n            }\n          })]\n        }), _jsxs(View, {\n          style: {\n            flexDirection: \"row\",\n            justifyContent: \"space-between\"\n          },\n          children: [_jsx(Button, {\n            style: {\n              padding: 8\n            },\n            onPress: function onPress() {\n              return setGroupSetting({\n                currentState: groupSettingState.Hidden\n              });\n            },\n            children: \"Cancel\"\n          }), _jsx(Button, {\n            style: {\n              padding: 8\n            },\n            onPress: function onPress() {\n              return onUpdateGroup();\n            },\n            children: \"Submit\"\n          })]\n        })]\n      })\n    }), _jsx(Portal, {\n      children: _jsxs(Modal, {\n        visible: groupSetting.currentState === groupSettingState.GroupMembers,\n        contentContainerStyle: screenStyles.pingModalContainerStyle,\n        children: [_jsxs(View, {\n          style: screenStyles.pingModalContent,\n          children: [_jsx(Text, {\n            style: {\n              fontSize: 18,\n              textAlign: \"center\"\n            },\n            children: \"Group Members\"\n          }), _jsx(FlatList, {\n            style: {\n              maxHeight: hp(60)\n            },\n            data: groupsMembers[groupSetting.id],\n            ListEmptyComponent: _jsx(Text, {\n              style: {\n                paddingLeft: 10,\n                textAlign: \"center\"\n              },\n              children: \"No members yet\"\n            }),\n            renderItem: function renderItem(_ref2) {\n              var item = _ref2.item,\n                  index = _ref2.index;\n              return _jsx(Card, {\n                style: {\n                  paddingLeft: 10\n                },\n                children: _jsxs(View, {\n                  style: {\n                    flexDirection: \"row\",\n                    justifyContent: \"space-between\",\n                    alignItems: \"center\"\n                  },\n                  children: [_jsx(Text, {\n                    children: item.name\n                  }), _jsx(IconButton, {\n                    color: \"crimson\",\n                    icon: \"close\",\n                    onPress: function onPress() {\n                      setGroupSetting(_objectSpread(_objectSpread({}, groupSetting), {}, {\n                        currentState: groupSettingState.RemoveMember,\n                        memberToRemove: item\n                      }));\n                    }\n                  })]\n                })\n              }, item.id);\n            },\n            ItemSeparatorComponent: function ItemSeparatorComponent() {\n              return _jsx(Gap, {\n                gapValue: \"1\",\n                type: \"col\"\n              });\n            },\n            keyExtractor: function keyExtractor(item) {\n              return item.id.toString();\n            },\n            ListFooterComponent: function ListFooterComponent() {\n              return _jsx(Gap, {\n                gapValue: \"2\",\n                type: \"col\"\n              });\n            },\n            ListHeaderComponent: function ListHeaderComponent() {\n              return _jsx(Gap, {\n                gapValue: \"1\",\n                type: \"col\"\n              });\n            }\n          })]\n        }), _jsx(Button, {\n          onPress: function onPress() {\n            return setGroupSetting({\n              currentState: groupSettingState.Hidden\n            });\n          },\n          style: screenStyles.pingModalButton,\n          children: \"Close\"\n        })]\n      })\n    }), _jsx(Portal, {\n      children: _jsxs(Modal, {\n        visible: groupSetting.currentState === groupSettingState.SelectMemberToAdd,\n        contentContainerStyle: screenStyles.pingModalContainerStyle,\n        children: [_jsxs(View, {\n          style: screenStyles.pingModalContent,\n          children: [_jsx(Text, {\n            style: {\n              fontSize: 18,\n              textAlign: \"center\"\n            },\n            children: \"Add New Group Member\"\n          }), _jsx(FlatList, {\n            style: {\n              maxHeight: hp(60)\n            },\n            data: newMembers,\n            ListEmptyComponent: newMembers === null ? _jsx(Text, {\n              style: {\n                paddingLeft: 10,\n                fontSize: 20,\n                textAlign: \"center\"\n              },\n              children: \"Loading, Please Wait...\"\n            }) : _jsx(Text, {\n              style: {\n                paddingLeft: 10,\n                textAlign: \"center\"\n              },\n              children: \"No members to add\"\n            }),\n            renderItem: function renderItem(_ref3) {\n              var item = _ref3.item,\n                  index = _ref3.index;\n              return _jsx(Card, {\n                style: {\n                  paddingLeft: 10\n                },\n                children: _jsxs(View, {\n                  style: {\n                    flexDirection: \"row\",\n                    justifyContent: \"space-between\",\n                    alignItems: \"center\"\n                  },\n                  children: [_jsx(Text, {\n                    children: item.name\n                  }), _jsx(IconButton, {\n                    color: \"green\",\n                    icon: \"check\",\n                    onPress: function onPress() {\n                      setGroupSetting(_objectSpread(_objectSpread({}, groupSetting), {}, {\n                        currentState: groupSettingState.AddMember,\n                        memberToAdd: item\n                      }));\n                    }\n                  })]\n                })\n              }, item.id);\n            },\n            ItemSeparatorComponent: function ItemSeparatorComponent() {\n              return _jsx(Gap, {\n                gapValue: \"1\",\n                type: \"col\"\n              });\n            },\n            keyExtractor: function keyExtractor(item) {\n              return item.id.toString();\n            },\n            ListFooterComponent: function ListFooterComponent() {\n              return _jsx(Gap, {\n                gapValue: \"2\",\n                type: \"col\"\n              });\n            },\n            ListHeaderComponent: function ListHeaderComponent() {\n              return _jsx(Gap, {\n                gapValue: \"1\",\n                type: \"col\"\n              });\n            }\n          })]\n        }), _jsx(Button, {\n          onPress: function onPress() {\n            return setGroupSetting({\n              currentState: groupSettingState.Hidden\n            });\n          },\n          style: screenStyles.pingModalButton,\n          children: \"Close\"\n        })]\n      })\n    }), _jsx(Portal, {\n      children: _jsxs(Modal, {\n        visible: groupSetting.currentState === groupSettingState.Options,\n        contentContainerStyle: screenStyles.pingModalContainerStyle,\n        children: [_jsxs(View, {\n          style: screenStyles.pingModalContent,\n          children: [_jsx(Text, {\n            style: {\n              fontSize: 18,\n              marginBottom: 10,\n              textAlign: \"center\"\n            },\n            children: \"Group Settings\"\n          }), _jsx(TouchableRipple, {\n            onPress: function onPress() {\n              return setGroupSetting(_objectSpread(_objectSpread({}, groupSetting), {}, {\n                currentState: groupSettingState.ChangeName\n              }));\n            },\n            children: _jsx(Card, {\n              style: {\n                padding: 16,\n                marginVertical: 3\n              },\n              children: _jsx(Text, {\n                children: \"Change Group Name\"\n              })\n            })\n          }), _jsx(TouchableRipple, {\n            onPress: function onPress() {\n              return setGroupSetting(_objectSpread(_objectSpread({}, groupSetting), {}, {\n                currentState: groupSettingState.GroupMembers\n              }));\n            },\n            children: _jsx(Card, {\n              style: {\n                padding: 16,\n                marginVertical: 3\n              },\n              children: _jsx(Text, {\n                children: \"Members\"\n              })\n            })\n          }), _jsx(TouchableRipple, {\n            onPress: function onPress() {\n              setGroupSetting(_objectSpread(_objectSpread({}, groupSetting), {}, {\n                currentState: groupSettingState.SelectMemberToAdd\n              }));\n              fetchNewMembers();\n            },\n            children: _jsx(Card, {\n              style: {\n                padding: 16,\n                marginVertical: 3\n              },\n              children: _jsx(Text, {\n                children: \"Add New Member\"\n              })\n            })\n          }), _jsx(TouchableRipple, {\n            onPress: function onPress() {\n              return setGroupSetting(_objectSpread(_objectSpread({}, groupSetting), {}, {\n                currentState: groupSettingState.DeleteGroup\n              }));\n            },\n            children: _jsx(Card, {\n              mode: \"elevated\",\n              style: {\n                padding: 16,\n                marginVertical: 3\n              },\n              children: _jsx(Text, {\n                children: \"Delete Group\"\n              })\n            })\n          })]\n        }), _jsx(Button, {\n          onPress: function onPress() {\n            return setGroupSetting({\n              currentState: groupSettingState.Hidden\n            });\n          },\n          style: screenStyles.pingModalButton,\n          children: \"Cancel\"\n        })]\n      })\n    }), _jsx(Portal, {\n      children: _jsxs(Modal, {\n        visible: pingModalVisible,\n        onDismiss: function onDismiss() {\n          return togglePingModal(false);\n        },\n        contentContainerStyle: screenStyles.pingModalContainerStyle,\n        children: [_jsxs(View, {\n          style: screenStyles.pingModalContent,\n          children: [_jsx(Text, {\n            style: {\n              fontSize: 18\n            },\n            children: \"Select an instructor to ping\"\n          }), _jsx(FlatList, {\n            data: admins,\n            renderItem: function renderItem(_ref4) {\n              var item = _ref4.item,\n                  index = _ref4.index;\n              return _jsx(TouchableRipple, {\n                onPress: function onPress() {\n                  return pingInstructor(item.id);\n                },\n                children: _jsx(Card, {\n                  style: {\n                    padding: 16\n                  },\n                  children: _jsx(Text, {\n                    children: item.name\n                  })\n                }, item.id)\n              });\n            },\n            ItemSeparatorComponent: function ItemSeparatorComponent() {\n              return _jsx(Gap, {\n                gapValue: \"1\",\n                type: \"col\"\n              });\n            },\n            keyExtractor: function keyExtractor(item) {\n              return item.id.toString();\n            },\n            ListFooterComponent: function ListFooterComponent() {\n              return _jsx(Gap, {\n                gapValue: \"2\",\n                type: \"col\"\n              });\n            },\n            ListHeaderComponent: function ListHeaderComponent() {\n              return _jsx(Gap, {\n                gapValue: \"1\",\n                type: \"col\"\n              });\n            }\n          })]\n        }), _jsx(Button, {\n          onPress: function onPress() {\n            return togglePingModal();\n          },\n          style: screenStyles.pingModalButton,\n          children: \"Cancel\"\n        })]\n      })\n    }), _jsx(Portal, {\n      children: _jsxs(Modal, {\n        visible: createGroupModalVisible,\n        onDismiss: function onDismiss() {\n          return setCreateGroupModalVisible(false);\n        },\n        contentContainerStyle: screenStyles.pingModalContainerStyle,\n        children: [_jsxs(View, {\n          style: screenStyles.pingModalContent,\n          children: [_jsx(Text, {\n            style: {\n              fontSize: 18\n            },\n            children: \"Create Group\"\n          }), _jsx(TextInput, {\n            placeholder: \"Group Name\",\n            multiline: false,\n            mode: \"outlined\",\n            style: {\n              height: 48,\n              marginVertical: 12\n            },\n            value: newGroupName,\n            onChangeText: function onChangeText(text) {\n              return setNewGroupName(text);\n            }\n          })]\n        }), _jsxs(View, {\n          style: {\n            flexDirection: \"row\",\n            justifyContent: \"space-between\"\n          },\n          children: [_jsx(Button, {\n            style: {\n              padding: 8\n            },\n            onPress: function onPress() {\n              return setCreateGroupModalVisible(false);\n            },\n            children: \"Cancel\"\n          }), _jsx(Button, {\n            style: {\n              padding: 8\n            },\n            onPress: function onPress() {\n              return onCreateGroup();\n            },\n            children: \"Submit\"\n          })]\n        })]\n      })\n    }), _jsx(FlatList, {\n      refreshControl: _jsx(RefreshControl, {\n        colors: [\"#9Bd35A\", \"#689F38\"],\n        refreshing: refreshing,\n        onRefresh: onRefresh\n      }),\n      data: groupsList,\n      renderItem: function renderItem(_ref5) {\n        var item = _ref5.item,\n            index = _ref5.index;\n        return _jsx(ChatCard, {\n          item: item,\n          index: index,\n          onCardPress: function onCardPress() {\n            return _onCardPress(item);\n          },\n          onCardLongPress: function onCardLongPress() {\n            return _onCardLongPress(item);\n          }\n        }, index);\n      },\n      ItemSeparatorComponent: function ItemSeparatorComponent() {\n        return _jsx(Gap, {\n          gapValue: \"1\",\n          type: \"col\"\n        });\n      },\n      keyExtractor: function keyExtractor(_, index) {\n        return index.toString();\n      },\n      ListFooterComponent: function ListFooterComponent() {\n        return _jsx(Gap, {\n          gapValue: \"3\",\n          type: \"col\"\n        });\n      },\n      ListHeaderComponent: function ListHeaderComponent() {\n        return _jsx(Gap, {\n          gapValue: \"1\",\n          type: \"col\"\n        });\n      }\n    }), _jsx(Portal, {\n      children: _jsx(FAB.Group, {\n        visible: showFab,\n        open: open,\n        icon: open ? \"window-close\" : \"plus\",\n        actions: fabActions,\n        onStateChange: onStateChange\n      })\n    })]\n  });\n};\n\nvar screenStyles = StyleSheet.create({\n  pingModalContainerStyle: {\n    margin: 20,\n    backgroundColor: \"white\",\n    borderRadius: 6\n  },\n  pingModalContent: {\n    paddingTop: 20,\n    paddingHorizontal: 20\n  },\n  pingModalButton: {\n    width: \"100%\",\n    paddingVertical: 10\n  },\n  flexBetween: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    width: \"100%\"\n  }\n});\nexport default Chat;","map":{"version":3,"sources":["C:/Users/Ahmed/Desktop/UniChat/Mobile/screen/chatScreen/Chat.js"],"names":["useNavigation","React","useState","useEffect","useCallback","ChatCard","Gap","styles","FAB","Modal","Portal","Text","Button","Card","TouchableRipple","TextInput","IconButton","PSUT_ChatroomApi","Cache","LoadingScreen","heightPercentageToDP","hp","groupSettingState","Hidden","Options","ChangeName","DeleteGroup","AddMember","RemoveMember","GroupMembers","SelectMemberToAdd","Chat","refreshing","setRefreshing","showFab","setShowFab","groupsList","setGroupsList","admins","setAdmins","groupsMembers","setGroupsMembers","pingModalVisible","setPingModalVisible","createGroupModalVisible","setCreateGroupModalVisible","newGroupName","setNewGroupName","loading","setLoading","currentState","groupSetting","setGroupSetting","newMembers","setNewMembers","nav","open","state","setState","onStateChange","fabActions","userData","role","icon","label","onPress","togglePingModal","small","onCreateGroup","createGroup","data","getGroupsList","alert","id","onUpdateGroup","updateGroup","onDeleteGroup","groupId","deleteGroup","onMemberRemove","userId","memberToRemove","removeMember","onMemberAdd","memberToAdd","addMember","isAdmin","fetchNewMembers","getNonExistingMembers","filterDataDto","array","mGroups","mAdmins","mGroupsMembers","group","push","name","conversationId","avatar_url","adminName","members","find","m","user","adminId","filter","map","u","a","addListener","cleanUp","getGroups","res","console","log","onRefresh","then","response","error","onCardPress","groupData","navigate","onCardLongPress","pingInstructor","instructorId","dto","content","recipientId","sendPing","status","JSON","stringify","undefined","pre","container","backgroundColor","screenStyles","pingModalContainerStyle","pingModalContent","fontSize","marginBottom","flexDirection","justifyContent","padding","height","marginVertical","text","textAlign","maxHeight","paddingLeft","item","index","alignItems","toString","pingModalButton","_","StyleSheet","create","margin","borderRadius","paddingTop","paddingHorizontal","width","paddingVertical","flexBetween"],"mappings":"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","sourcesContent":["import { useNavigation } from \"@react-navigation/native\";\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport { View, FlatList, RefreshControl, StyleSheet } from \"react-native\";\nimport ChatCard from \"../../componnetns/ChatCard\";\nimport Gap from \"../../componnetns/Gap\";\nimport { styles } from \"../../style/style\";\nimport {\n  FAB,\n  Modal,\n  Portal,\n  Text,\n  Button,\n  Card,\n  TouchableRipple,\n  TextInput,\n  IconButton,\n} from \"react-native-paper\";\nimport { PSUT_ChatroomApi } from \"../../api/routeApi\";\nimport { Cache } from \"../../helpers/cache\";\nimport LoadingScreen from \"../../componnetns/LoadingScreen\";\nimport { heightPercentageToDP as hp } from \"react-native-responsive-screen\";\n\nconst groupSettingState = {\n  Hidden: 1,\n  Options: 2,\n  ChangeName: 3,\n  DeleteGroup: 4,\n  AddMember: 5,\n  RemoveMember: 6,\n  GroupMembers: 7,\n  SelectMemberToAdd: 8,\n};\n\nconst Chat = () => {\n  const [refreshing, setRefreshing] = useState(false);\n  const [showFab, setShowFab] = useState(true);\n  const [groupsList, setGroupsList] = useState([]);\n  const [admins, setAdmins] = useState([]);\n  const [groupsMembers, setGroupsMembers] = useState({});\n  const [pingModalVisible, setPingModalVisible] = useState(false);\n  const [createGroupModalVisible, setCreateGroupModalVisible] = useState(false);\n  const [newGroupName, setNewGroupName] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [groupSetting, setGroupSetting] = useState({\n    currentState: groupSettingState.Hidden,\n  });\n  const [newMembers, setNewMembers] = useState(null);\n  const nav = useNavigation();\n\n  const [state, setState] = useState({ open: false });\n  const onStateChange = ({ open }) => setState({ open });\n  const { open } = state;\n\n  const fabActions =\n    Cache.userData.role === \"Student\"\n      ? [\n          {\n            icon: \"bell\",\n            label: \"Ping Instructor\",\n            onPress: () => togglePingModal(true),\n            small: false,\n          },\n        ]\n      : Cache.userData.role === \"Instructor\"\n      ? [\n          {\n            icon: \"message-plus-outline\",\n            label: \"Create new group\",\n            onPress: () => setCreateGroupModalVisible(true),\n            small: false,\n          },\n        ]\n      : [];\n\n  const onCreateGroup = async () => {\n    if (!newGroupName) return;\n    setCreateGroupModalVisible(false);\n    setLoading(true);\n    try {\n      const { data } = await PSUT_ChatroomApi.createGroup(newGroupName);\n      await getGroupsList();\n      setLoading(false);\n      setNewGroupName(\"\");\n      alert(`Created Successfully, with ID: ${data.id}`);\n    } catch (error) {\n      setLoading(false);\n      alert(\"Failed to create\");\n    }\n  };\n\n  const onUpdateGroup = async () => {\n    if (!newGroupName) return;\n    setGroupSetting({\n      ...groupSetting,\n      currentState: groupSettingState.Hidden,\n    });\n    setLoading(true);\n    try {\n      await PSUT_ChatroomApi.updateGroup(groupSetting.id, newGroupName);\n      await getGroupsList();\n      setLoading(false);\n      setNewGroupName(\"\");\n      alert(`Updated Successfully`);\n    } catch (error) {\n      setLoading(false);\n      alert(\"Failed to update\");\n    }\n  };\n\n  const onDeleteGroup = async () => {\n    const groupId = groupSetting.id;\n    setGroupSetting({ currentState: groupSettingState.Hidden });\n    setLoading(true);\n    try {\n      await PSUT_ChatroomApi.deleteGroup([groupId]);\n      await getGroupsList();\n      setLoading(false);\n      alert(`Deleted Successfully`);\n    } catch (error) {\n      setLoading(false);\n      alert(\"Failed to delete\");\n    }\n  };\n\n  const onMemberRemove = async () => {\n    const groupId = groupSetting.id;\n    const userId = groupSetting.memberToRemove.id;\n    setGroupSetting({ currentState: groupSettingState.Hidden });\n    setLoading(true);\n    try {\n      await PSUT_ChatroomApi.removeMember({ groupId, userId });\n      await getGroupsList();\n      setLoading(false);\n      alert(`Removed Successfully`);\n    } catch (error) {\n      setLoading(false);\n      alert(\"Failed to remove\");\n    }\n  };\n\n  const onMemberAdd = async () => {\n    const groupId = groupSetting.id;\n    const userId = groupSetting.memberToAdd.id;\n    setGroupSetting({ currentState: groupSettingState.Hidden });\n    setLoading(true);\n    try {\n      await PSUT_ChatroomApi.addMember({ groupId, userId, isAdmin: false });\n      await getGroupsList();\n      setLoading(false);\n      alert(`Added Successfully`);\n    } catch (error) {\n      setLoading(false);\n      alert(\"Failed to add\");\n    }\n  };\n\n  const fetchNewMembers = async () => {\n    try {\n      const { data } = await PSUT_ChatroomApi.getNonExistingMembers(groupSetting.id);\n      setNewMembers(data);\n    } catch (error) {\n      setNewMembers([]);\n    }\n  };\n\n  const filterDataDto = (array = []) => {\n    const mGroups = [];\n    const mAdmins = [];\n    const mGroupsMembers = {};\n    for (const group of array) {\n      mGroups.push({\n        id: group.id,\n        name: group.name,\n        conversationId: group.conversationId,\n        avatar_url: `https://source.unsplash.com/random?sig=${group.id}`,\n        adminName: group.members.find((m) => m.isAdmin).user.name,\n        adminId: group.members.find((m) => m.isAdmin).user.id,\n      });\n\n      mGroupsMembers[group.id] = [\n        ...group.members.filter((m) => !m.isAdmin).map((u) => u.user),\n      ];\n\n      mAdmins.push(\n        ...group.members\n          .filter((m) => m.isAdmin && !mAdmins.find((a) => a.id === m.user.id))\n          .map((u) => u.user)\n      );\n    }\n\n    setGroupsList(mGroups);\n    setAdmins(mAdmins);\n    setGroupsMembers(mGroupsMembers);\n  };\n\n  useEffect(() => {\n    nav.addListener(\"blur\", () => setShowFab(false));\n    const cleanUp = nav.addListener(\"focus\", () => {\n      setShowFab(true);\n      getGroupsList();\n    });\n\n    return () => cleanUp();\n  }, [nav]); \n\n  const getGroupsList = async () => {\n    try {\n      const res = await PSUT_ChatroomApi.getGroups();\n      filterDataDto(res.data);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const onRefresh = useCallback(() => {\n    setRefreshing(true);\n    getGroupsList().then(\n      response => {\n        setRefreshing(false);\n      }, error => {\n        setRefreshing(false);\n      }\n    );\n  }, []);\n\n  const onCardPress = async (groupData) => {\n    nav.navigate(\"Meassge\", groupData);\n  };\n\n  const onCardLongPress = async (groupData) => {\n    if (Cache.userData.id === groupData.adminId) {\n      setGroupSetting({\n        ...groupData,\n        currentState: groupSettingState.Options,\n      });\n    } else {\n      alert(\"Only group admin can access it's settings\");\n    }\n  };\n\n  async function pingInstructor(instructorId) {\n    togglePingModal();\n    const dto = {\n      content: \"PING\",\n      recipientId: instructorId,\n    };\n\n    console.log(dto);\n    try {\n      await PSUT_ChatroomApi.sendPing(dto);\n      alert(\"Ping sent successfully\");\n    } catch (e) {\n      if (e?.response?.status === 422) {\n        alert(\"Selected instructor has already been pinged before\");\n      }\n      console.log(JSON.stringify(e));\n    }\n  }\n\n  const togglePingModal = (state = undefined) =>\n    setPingModalVisible((pre) => (state !== undefined ? state : !pre));\n\n  return (\n    <View style={[styles.container, { backgroundColor: \"#F8F8F8\" }]}>\n      <LoadingScreen visible={loading} />\n      {/* Delete */}\n      <Portal>\n        <Modal\n          visible={groupSetting.currentState === groupSettingState.DeleteGroup}\n          contentContainerStyle={screenStyles.pingModalContainerStyle}\n        >\n          <View style={screenStyles.pingModalContent}>\n            <Text style={{ fontSize: 18, marginBottom: 20 }}>\n              Are you sure you want to delete the group?\n            </Text>\n          </View>\n          <View\n            style={{ flexDirection: \"row\", justifyContent: \"space-between\" }}\n          >\n            <Button\n              style={{ padding: 8 }}\n              onPress={() =>\n                setGroupSetting({ currentState: groupSettingState.Hidden })\n              }\n            >\n              Cancel\n            </Button>\n            <Button\n              color=\"crimson\"\n              style={{ padding: 8 }}\n              onPress={() => onDeleteGroup()}\n            >\n              Yes, Delete it!\n            </Button>\n          </View>\n        </Modal>\n      </Portal>\n      {/* Remove Member */}\n      <Portal>\n        <Modal\n          visible={groupSetting.currentState === groupSettingState.RemoveMember}\n          contentContainerStyle={screenStyles.pingModalContainerStyle}\n        >\n          <View style={screenStyles.pingModalContent}>\n            <Text style={{ fontSize: 18, marginBottom: 20 }}>\n              Are you sure you want to remove{\" \"}\n              {groupSetting?.memberToRemove?.name} from the group?\n            </Text>\n          </View>\n          <View\n            style={{ flexDirection: \"row\", justifyContent: \"space-between\" }}\n          >\n            <Button\n              style={{ padding: 8 }}\n              onPress={() =>\n                setGroupSetting({ currentState: groupSettingState.Hidden })\n              }\n            >\n              Cancel\n            </Button>\n            <Button\n              color=\"crimson\"\n              style={{ padding: 8 }}\n              onPress={() => onMemberRemove()}\n            >\n              Yes, Remove!\n            </Button>\n          </View>\n        </Modal>\n      </Portal>\n      {/* Add Member */}\n      <Portal>\n        <Modal\n          visible={groupSetting.currentState === groupSettingState.AddMember}\n          contentContainerStyle={screenStyles.pingModalContainerStyle}\n        >\n          <View style={screenStyles.pingModalContent}>\n            <Text style={{ fontSize: 18, marginBottom: 20 }}>\n              Are you sure you want to add {groupSetting?.memberToAdd?.name} to\n              the group?\n            </Text>\n          </View>\n          <View\n            style={{ flexDirection: \"row\", justifyContent: \"space-between\" }}\n          >\n            <Button\n              style={{ padding: 8 }}\n              onPress={() =>\n                setGroupSetting({ currentState: groupSettingState.Hidden })\n              }\n            >\n              Cancel\n            </Button>\n            <Button\n              color=\"green\"\n              style={{ padding: 8 }}\n              onPress={() => onMemberAdd()}\n            >\n              Yes, Add\n            </Button>\n          </View>\n        </Modal>\n      </Portal>\n      {/* Change Name */}\n      <Portal>\n        <Modal\n          visible={groupSetting.currentState === groupSettingState.ChangeName}\n          contentContainerStyle={screenStyles.pingModalContainerStyle}\n        >\n          <View style={screenStyles.pingModalContent}>\n            <Text style={{ fontSize: 18 }}>Change Group Name</Text>\n            <TextInput\n              placeholder=\"New Group Name\"\n              multiline={false}\n              mode=\"outlined\"\n              style={{ height: 48, marginVertical: 12 }}\n              value={newGroupName}\n              onChangeText={(text) => setNewGroupName(text)}\n            />\n          </View>\n          <View\n            style={{ flexDirection: \"row\", justifyContent: \"space-between\" }}\n          >\n            <Button\n              style={{ padding: 8 }}\n              onPress={() =>\n                setGroupSetting({ currentState: groupSettingState.Hidden })\n              }\n            >\n              Cancel\n            </Button>\n            <Button style={{ padding: 8 }} onPress={() => onUpdateGroup()}>\n              Submit\n            </Button>\n          </View>\n        </Modal>\n      </Portal>\n      {/* Members */}\n      <Portal>\n        <Modal\n          visible={groupSetting.currentState === groupSettingState.GroupMembers}\n          contentContainerStyle={screenStyles.pingModalContainerStyle}\n        >\n          <View style={screenStyles.pingModalContent}>\n            <Text style={{ fontSize: 18, textAlign: \"center\" }}>\n              Group Members\n            </Text>\n            <FlatList\n              style={{ maxHeight: hp(60) }}\n              data={groupsMembers[groupSetting.id]}\n              ListEmptyComponent={\n                <Text style={{ paddingLeft: 10, textAlign: \"center\" }}>\n                  No members yet\n                </Text>\n              }\n              renderItem={({ item, index }) => (\n                <Card style={{ paddingLeft: 10 }} key={item.id}>\n                  <View\n                    style={{\n                      flexDirection: \"row\",\n                      justifyContent: \"space-between\",\n                      alignItems: \"center\",\n                    }}\n                  >\n                    <Text>{item.name}</Text>\n                    <IconButton\n                      color=\"crimson\"\n                      icon=\"close\"\n                      onPress={() => {\n                        setGroupSetting({\n                          ...groupSetting,\n                          currentState: groupSettingState.RemoveMember,\n                          memberToRemove: item,\n                        });\n                      }}\n                    />\n                  </View>\n                </Card>\n              )}\n              ItemSeparatorComponent={() => <Gap gapValue=\"1\" type=\"col\" />}\n              keyExtractor={(item) => item.id.toString()}\n              ListFooterComponent={() => <Gap gapValue=\"2\" type=\"col\" />}\n              ListHeaderComponent={() => <Gap gapValue=\"1\" type=\"col\" />}\n            />\n          </View>\n          <Button\n            onPress={() =>\n              setGroupSetting({ currentState: groupSettingState.Hidden })\n            }\n            style={screenStyles.pingModalButton}\n          >\n            Close\n          </Button>\n        </Modal>\n      </Portal>\n      {/* Select Member to add */}\n      <Portal>\n        <Modal\n          visible={\n            groupSetting.currentState === groupSettingState.SelectMemberToAdd\n          }\n          contentContainerStyle={screenStyles.pingModalContainerStyle}\n        >\n          <View style={screenStyles.pingModalContent}>\n            <Text style={{ fontSize: 18, textAlign: \"center\" }}>\n              Add New Group Member\n            </Text>\n            <FlatList\n              style={{ maxHeight: hp(60) }}\n              data={newMembers}\n              ListEmptyComponent={\n                newMembers === null ? (\n                  <Text\n                    style={{\n                      paddingLeft: 10,\n                      fontSize: 20,\n                      textAlign: \"center\",\n                    }}\n                  >\n                    Loading, Please Wait...\n                  </Text>\n                ) : (\n                  <Text style={{ paddingLeft: 10, textAlign: \"center\" }}>\n                    No members to add\n                  </Text>\n                )\n              }\n              renderItem={({ item, index }) => (\n                <Card style={{ paddingLeft: 10 }} key={item.id}>\n                  <View\n                    style={{\n                      flexDirection: \"row\",\n                      justifyContent: \"space-between\",\n                      alignItems: \"center\",\n                    }}\n                  >\n                    <Text>{item.name}</Text>\n                    <IconButton\n                      color=\"green\"\n                      icon=\"check\"\n                      onPress={() => {\n                        setGroupSetting({\n                          ...groupSetting,\n                          currentState: groupSettingState.AddMember,\n                          memberToAdd: item,\n                        });\n                      }}\n                    />\n                  </View>\n                </Card>\n              )}\n              ItemSeparatorComponent={() => <Gap gapValue=\"1\" type=\"col\" />}\n              keyExtractor={(item) => item.id.toString()}\n              ListFooterComponent={() => <Gap gapValue=\"2\" type=\"col\" />}\n              ListHeaderComponent={() => <Gap gapValue=\"1\" type=\"col\" />}\n            />\n          </View>\n          <Button\n            onPress={() =>\n              setGroupSetting({ currentState: groupSettingState.Hidden })\n            }\n            style={screenStyles.pingModalButton}\n          >\n            Close\n          </Button>\n        </Modal>\n      </Portal>\n      {/* Settings */}\n      <Portal>\n        <Modal\n          visible={groupSetting.currentState === groupSettingState.Options}\n          contentContainerStyle={screenStyles.pingModalContainerStyle}\n        >\n          <View style={screenStyles.pingModalContent}>\n            <Text\n              style={{ fontSize: 18, marginBottom: 10, textAlign: \"center\" }}\n            >\n              Group Settings\n            </Text>\n            <TouchableRipple\n              onPress={() =>\n                setGroupSetting({\n                  ...groupSetting,\n                  currentState: groupSettingState.ChangeName,\n                })\n              }\n            >\n              <Card style={{ padding: 16, marginVertical: 3 }}>\n                <Text>Change Group Name</Text>\n              </Card>\n            </TouchableRipple>\n            <TouchableRipple\n              onPress={() =>\n                setGroupSetting({\n                  ...groupSetting,\n                  currentState: groupSettingState.GroupMembers,\n                })\n              }\n            >\n              <Card style={{ padding: 16, marginVertical: 3 }}>\n                <Text>Members</Text>\n              </Card>\n            </TouchableRipple>\n            <TouchableRipple\n              onPress={() => {\n                setGroupSetting({\n                  ...groupSetting,\n                  currentState: groupSettingState.SelectMemberToAdd,\n                });\n                fetchNewMembers();\n              }}\n            >\n              <Card style={{ padding: 16, marginVertical: 3 }}>\n                <Text>Add New Member</Text>\n              </Card>\n            </TouchableRipple>\n            <TouchableRipple\n              onPress={() =>\n                setGroupSetting({\n                  ...groupSetting,\n                  currentState: groupSettingState.DeleteGroup,\n                })\n              }\n            >\n              <Card mode=\"elevated\" style={{ padding: 16, marginVertical: 3 }}>\n                <Text>Delete Group</Text>\n              </Card>\n            </TouchableRipple>\n          </View>\n          <Button\n            onPress={() =>\n              setGroupSetting({ currentState: groupSettingState.Hidden })\n            }\n            style={screenStyles.pingModalButton}\n          >\n            Cancel\n          </Button>\n        </Modal>\n      </Portal>\n      {/* Ping modal */}\n      <Portal>\n        <Modal\n          visible={pingModalVisible}\n          onDismiss={() => togglePingModal(false)}\n          contentContainerStyle={screenStyles.pingModalContainerStyle}\n        >\n          <View style={screenStyles.pingModalContent}>\n            <Text style={{ fontSize: 18 }}>Select an instructor to ping</Text>\n            <FlatList\n              data={admins}\n              renderItem={({ item, index }) => (\n                <TouchableRipple onPress={() => pingInstructor(item.id)}>\n                  <Card style={{ padding: 16 }} key={item.id}>\n                    <Text>{item.name}</Text>\n                  </Card>\n                </TouchableRipple>\n              )}\n              ItemSeparatorComponent={() => <Gap gapValue=\"1\" type=\"col\" />}\n              keyExtractor={(item) => item.id.toString()}\n              ListFooterComponent={() => <Gap gapValue=\"2\" type=\"col\" />}\n              ListHeaderComponent={() => <Gap gapValue=\"1\" type=\"col\" />}\n            />\n          </View>\n          <Button\n            onPress={() => togglePingModal()}\n            style={screenStyles.pingModalButton}\n          >\n            Cancel\n          </Button>\n        </Modal>\n      </Portal>\n      {/* Create Group */}\n      <Portal>\n        <Modal\n          visible={createGroupModalVisible}\n          onDismiss={() => setCreateGroupModalVisible(false)}\n          contentContainerStyle={screenStyles.pingModalContainerStyle}\n        >\n          <View style={screenStyles.pingModalContent}>\n            <Text style={{ fontSize: 18 }}>Create Group</Text>\n            <TextInput\n              placeholder=\"Group Name\"\n              multiline={false}\n              mode=\"outlined\"\n              style={{ height: 48, marginVertical: 12 }}\n              value={newGroupName}\n              onChangeText={(text) => setNewGroupName(text)}\n            />\n          </View>\n          <View\n            style={{ flexDirection: \"row\", justifyContent: \"space-between\" }}\n          >\n            <Button\n              style={{ padding: 8 }}\n              onPress={() => setCreateGroupModalVisible(false)}\n            >\n              Cancel\n            </Button>\n            <Button style={{ padding: 8 }} onPress={() => onCreateGroup()}>\n              Submit\n            </Button>\n          </View>\n        </Modal>\n      </Portal>\n      <FlatList\n        refreshControl={\n          <RefreshControl\n            colors={[\"#9Bd35A\", \"#689F38\"]}\n            refreshing={refreshing}\n            onRefresh={onRefresh}\n          />\n        }\n        data={groupsList}\n        renderItem={({ item, index }) => (\n          <ChatCard\n            key={index}\n            item={item}\n            index={index}\n            onCardPress={() => onCardPress(item)}\n            onCardLongPress={() => onCardLongPress(item)}\n          />\n        )}\n        ItemSeparatorComponent={() => <Gap gapValue=\"1\" type=\"col\" />}\n        keyExtractor={(_, index) => index.toString()}\n        ListFooterComponent={() => <Gap gapValue=\"3\" type=\"col\" />}\n        ListHeaderComponent={() => <Gap gapValue=\"1\" type=\"col\" />}\n      />\n      <Portal>\n        <FAB.Group\n          visible={showFab}\n          open={open}\n          icon={open ? \"window-close\" : \"plus\"}\n          actions={fabActions}\n          onStateChange={onStateChange}\n        />\n      </Portal>\n    </View>\n  );\n};\n\nconst screenStyles = StyleSheet.create({\n  pingModalContainerStyle: {\n    margin: 20,\n    backgroundColor: \"white\",\n    borderRadius: 6,\n  },\n  pingModalContent: {\n    paddingTop: 20,\n    paddingHorizontal: 20,\n  },\n  pingModalButton: {\n    width: \"100%\",\n    paddingVertical: 10,\n  },\n  flexBetween: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    width: \"100%\",\n  },\n});\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}